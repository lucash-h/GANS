# My GAN repository

This repository contains several General Aversarial network models. 
Currently the following models are included:
* GAN at ```MNIST_GAN.ipynb```
* Manifold Guided Gan at ```MGGAN.ipynb```

## General GAN Structure
### Generator
This neural network uses several layers, including convolutions, to generate images ressembling the given dataset. It takes a noise input of, in this case 100, and outputs a 28 by 28 by 1 image.


### Discriminator
The discriminator neural network uses several layers to attempt to discern images created by the generator and images from the dataset. The input to the discriminator is an image, and this model outputs a value between 0 and 1. Closer to 0 indicates a higher probability of the image being generated, and a value closer to 1 suggests a higher probability that the image is real.

## GAN - MNIST Digits
This is an implementation of a general adversarial network in tensorflow, that uses two neural networks, a generator and a discriminator, to generate images that ressemble, in this case the MNSIT digit dataset. Working in tandem, the generator attempts to generate images to fool the discriminator, while the discriminator attempts to identify whether an image was generated by the generator or if it is a real image from the dataset.

### Generator
![generator_image](https://github.com/lucash-h/MNIST_GAN/assets/93152056/acf40336-4210-412e-a8da-03a3b654a98a)


### Discriminator
![discriminator_image](https://github.com/lucash-h/MNIST_GAN/assets/93152056/6a4882ce-85e3-422a-aea0-1259a5acb8b7)


### Plotting metrics
There is a function called plot_metric that is used to plot generator and discriminator loss, and accuracy.
These are kept track of in the loss log dictionary, where loss is updated for every batch in every epoch
while the accuracy is updated every epoch. 

### Variables and hyperparameters
These can be found near the beginning of the colab or IDE file to be easily changed
* batch size is the number of images in a batch
* epochs is the number of training iterations the model goes through
* noise dimension is the dimensions of the random noise vector that is input for the generator. This also refers to the dimension of the generator input.
* learning rate of discriminator/generator refers to the step size at which model parameters are updated during optimization. In other words, it controls the rate at which the model learns.

### Running the Project in Google Colab
1. Navigate to the `MNIST_GAN.ipynb` file.
2. Click on the "Open in Colab" button at the top of the file.
3. Ensure that the runtime type is set to Python 3 by clicking on the "Runtime" menu, then "Change runtime type", and selecting "Python 3".
4. if available, change Hardware accelerator to T4 GPU, or a different option as CPU is not fast
5. Run the entire notebook by clicking on the "Runtime" menu and selecting "Run all". Alternatively, run each cell individually by clicking on the play button to the left of each cell.


## Manifold Guided GAN
This model roughly follows the GAN structure, with an extra model. The reason for this change is due to the difficulty in training GANs, specifically this model is attempting to reduce mode collapse. Mode collapse is when the generator begins to reproduce a minimal amount of types of samples to minimize its loss. An example of this is a generator that only produces 8s from the MNIST dataset, rather than accurate digits from 0 - 10. 

To mitigate this, the MGGAN implements an additional encoder, which compresses the image, to another discriminator model, in addition to the regular GAN. The basic concept is as follows:
1. The generator generates images
2. those images are passed into an encoder, which reduces the shape from 28,28,1 to say, a single dimension with 64 elements. 
3. Those encoded images are passed through a *latent* discriminator
4. the loss of this latent discriminator is another parameter for the generator loss, mitigating mode collapse

Meanwhile, the generated image is also passed through a standard, *pixel* discriminator which plays a part in the generator loss, along with the latent discriminator loss.

![image](https://github.com/lucash-h/GANS/assets/93152056/0bbc7764-8223-43da-af1b-bcdcc90a2563)
This drawing gives a better visualization of the dimensions and basic structure of this type of GAN.



### More on this to come 

### Running the Project in Google Colab
1. Navigate to the `MGGAN.ipynb` file.
2. Click on the "Open in Colab" button at the top of the file.
3. Ensure that the runtime type is set to Python 3 by clicking on the "Runtime" menu, then "Change runtime type", and selecting "Python 3".
4. if available, change Hardware accelerator to T4 GPU, or a different option as CPU is quite slow
5. Run the entire notebook by clicking on the "Runtime" menu and selecting "Run all". Alternatively, run each cell individually by clicking on the play button to the left of each cell.
